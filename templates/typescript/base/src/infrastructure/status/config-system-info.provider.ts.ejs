import packageJson from '../../../package.json';
import { SystemInfoProvider, SystemInfoSnapshot } from '../../domain/status/system-info';
import { env } from '../config/env';
import { templateInfo } from '../config/template-info';

export class ConfigSystemInfoProvider implements SystemInfoProvider {
  async getSnapshot(): Promise<SystemInfoSnapshot> {
    return {
      name: env.APP_NAME,
      version: packageJson.version ?? '0.0.0',
      environment: process.env.NODE_ENV ?? 'development',
      port: env.API_PORT,
      documentationUrl: '/docs',
      features: templateInfo.features.map((feature) => ({ ...feature })),
      dependencies: templateInfo.dependencies.map((dependency) => ({ ...dependency })),
    };
  }
}
